<?php
include('connProd.php') ;
$imei[]=array(864826052670836,864826052635870,864826052655415,864826052566349,864826056022935,864826052564005,864826052566448,864826052503839,864826052682013,864826056211132,864826056197489,864826052569251,864826052566455,864826052566653,864826052566299,864826052703603,864826052565986,864826056077632,864826052580878,864826052569079,864826056155149,864826052472688,864826052503854,864826052504621,864826052620286,864826052504647,864826052504795,864826052567305,864826052669572,864826052681189,864826052683904,864826056180774,864826056063111,864826052658393,864826056053351,864826056117503,864826056060083,864826056057667,864826052610519,864826052661553,864826052657569,864826052667923,864826052664110,864826052648659,864826052666917,864826052684225,864826056195202,864826052681262,864826052681379,864826052582239,864826052509505,864826056039285,864826056015079,864826056014817,864826056035267,864826056031852,864826056033429,864826056035358,864826056033312,864826056035390,864826056035408,864826056035481,864826056024584,864826056018859,864826056035341,864826056021564,864826056021283,864826056021424,864826056036521,864826056035499,864826056033361,864826056021481,864826056016903,864826056021499,864826056028874,864826056021275,864826056037313,864826056018909,864826056021465,864826056124756,864826056055414,864826056165213,864826056041547,864826056111563,864826056144721,864826056103982,864826056076196,864826056106670,864826056085593,864826056104147,864826056110714,864826056104212,864826056011342,864826056034393,864826056037347,864826056172185,864826056106373,864826056039087,864826056011755,864826056037685,864826056043535,864826056106639,864826056176657,864826056106340,864826056036919,864826056111621,864826056038055,864826056106423,864826056036760,864826056030979,864826056031084,864826056061834,864826056060240,864826056060133,864826056142790,864826056015541,864826056015566,864826056014924,864826056096178,864826056024774,864826056142808,864826056067054,864826056059135,864826056014429,864826056012613,864826056183042,864826056013538,864826056014932,864826056039012,864826056116596,864826056061172,864826056063145,864826056060216,864826056063228,864826056093183,864826056137758,864826056091088,864826056029484,864826056066049,864826056175956,864826056065462,864826056137725,864826056093274,864826056113148,864826056056446,864826056094132,864826056019410,864826056092466,864826056019246,864826056023701,864826056057535,864826056121703,864826052475418,864826052505776,864826052504654,864826052599688,864826052699074,864826052695106,864826056095469,864826056019022,864826056035218,864826056035291,864826056034906,864826056037214,864826056024634,864826056024485,864826056024527,864826056124384,864826056067005,864826056106589,864826056106621,864826056067047,864826056013603,864826056106563,864826056034898,864826056122040,864826056011797,864826052540146,864826056106712,864826056043576,864826056037834,864826056018966,864826056045886,864826056018685,864826056018990,864826056039053,864826056048476,864826056038758,864826056038923,864826056018792,864826056018016,864826056042800,864826056030821,864826056058921,864826056061800,864826056059143,864826056058954,864826056037982,864826056039293,864826056096830,864826056067096,864826056059093,864826056032926,864826056114880,864826056085957,864826056066411,864826056092946,864826056028031,864826056057519,864826056142725,864826056165130,864826056165247,864826056057022,864826056057261,864826052513572,864826052526665,864826052504753,864826052509414,864826052509422,864826056111555,864826056121570,864826056037289,864826052641779,864826056209573,864826056034781,864826056156782,864826056063681,864826056116448,864826056031407,864826056106415,864826056029518,864826056067187,864826056033957,864826056029732,864826056109120,864826056084604,864826056085692,864826056065504,864826056048872,864826056156907,864826056105813,864826056139978,864826056121737,864826056019733,864826056020087,864826056015046,864826056019170,864826056018669,864826056019576,864826056053906,864826056019642,864826056043873,864826056050076,864826056046926,864826056177994,864826056142592,864826056023859,864826056173811,864826056127452,864826056049441,864826056051595,864826056038410,864826056055992,864826056032058,864826056043592,864826056121620,864826056111704,864826056201604,864826056021713,864826056014411,864826056106456,864826056030573,864826056109286,864826056164893,864826056137790,864826056048807,864826056048849,864826056023313,864826056071726,864826056094819,864826056115333,864826056035044,864826056043816,864826056032637,864826056172276,864826056024741,864826056015178,864826056116109,864826052708388,864826052684159,864826052679548,864826052617928,864826052679613,864826056063640,864826056066213,864826056065397,864826056055224,864826056087227,864826056112421,864826056175808,864826056107710,864826056023289,864826056019139,864826056057345,864826056044046,864826056050175,864826056019188,864826056137964,864826056148516,864826056106001,864826056034831,864826056116406,864826056012084,864826056093365,864826056032272,864826056144507,864826056032587,864826056105698,864826056094520,864826056011599,864826052564856,864826052582973);
for ($b=0;$b<=count($imei[0]);$b++){
    $result  = $session->execute("SELECT trackerid FROM trackers_by_imei WHERE imei ='".$imei[0][$b]."'");
    foreach ($result as $row) {
        $trackersData=$row['trackerid'];
    }
    $curl = curl_init();

    curl_setopt_array($curl, array(
      CURLOPT_URL => '172.16.1.7:12003/api/vehicle/renew',
      CURLOPT_RETURNTRANSFER => true,
      CURLOPT_ENCODING => '',
      CURLOPT_MAXREDIRS => 10,
      CURLOPT_TIMEOUT => 0,
      CURLOPT_FOLLOWLOCATION => true,
      CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
      CURLOPT_CUSTOMREQUEST => 'POST',
      CURLOPT_POSTFIELDS =>'{
        "trackerId": ["'.$trackersData.'"]
    }',
      CURLOPT_HTTPHEADER => array(
        'Content-Type: application/json',
        'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI1OTc3MDBkOWI5OTZhNzEwMzA4YjQ1NzAiLCJpYXQiOjE3MDI0NTQ1NzcsImV4cCI6MTcwMjQ5Nzc3N30.55nrg_BtqC8gwS4xGf6p5AmX-6n6OluHJnFvekTlheY'
      ),
    ));
    
    $response = curl_exec($curl);
    
    curl_close($curl);
    print_r($imei[0][$b]);
    echo " - ".$response." - ";
    echo $trackersData."<br>";
}

?>